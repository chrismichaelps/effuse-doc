---
title: 国際化 (i18n)
---

# 国際化

`@effuse/i18n` パッケージは、リアクティブなロケール切り替えを備えた型安全な国際化を提供します。

## セットアップ

```typescript
import { createI18n } from '@effuse/i18n';

const translations = {
	en: {
		greeting: 'Hello, {{name}}!',
		app: {
			title: 'My App',
		},
		items: {
			count_one: '{{count}} item',
			count_other: '{{count}} items',
		},
	},
	es: {
		greeting: '¡Hola, {{name}}!',
		app: {
			title: 'Mi Aplicación',
		},
		items: {
			count_one: '{{count}} elemento',
			count_other: '{{count}} elementos',
		},
	},
};

createI18n({
	defaultLocale: 'en',
	fallbackLocale: 'en',
	translations,
	detectLocale: true,
	persistLocale: true,
});
```

## 翻訳の使用

コンポーネントで `useTranslation` フックを使用します：

```tsx
import { define, computed, signal } from '@effuse/core';
import { useTranslation } from '@effuse/i18n';

const Greeting = define({
	script: () => {
		const { t, locale, setLocale } = useTranslation();
		const userName = signal('World');

		return {
			greeting: computed(() => t('greeting', { name: userName.value })),
			toggleLocale: () => setLocale(locale.value === 'en' ? 'es' : 'en'),
		};
	},
	template: ({ greeting, toggleLocale }) => (
		<div>
			<p>{greeting}</p>
			<button onClick={toggleLocale}>Change Language</button>
		</div>
	),
});
```

## ネストしたキー

ドット記法でネストした翻訳にアクセス：

```typescript
const { t } = useTranslation();

t('app.title'); // "My App"
```

## 変数の補間

`{{variable}}` 構文で変数を渡します：

```typescript
t('greeting', { name: 'Developer' }); // "Hello, Developer!"
```

## 複数形

`_one`、`_other`、`_zero`、`_two`、`_few`、`_many` サフィックスで複数形を定義：

```typescript
// 翻訳内
items: {
  count_one: '{{count}} item',
  count_other: '{{count}} items',
}

// 使用法
t('items.count', { count: 1 });  // "1 item"
t('items.count', { count: 5 });  // "5 items"
```

## API リファレンス

### `createI18n(options)`

i18n インスタンスを初期化します。アプリ起動時に一度呼び出します。

| オプション       | 型                  | デフォルト | 説明                                   |
| :--------------- | :------------------ | :--------- | :------------------------------------- |
| `defaultLocale`  | `string`            | —          | 使用するデフォルトロケール。           |
| `fallbackLocale` | `string`            | —          | 翻訳がない場合のフォールバック。       |
| `translations`   | `Record<string, T>` | —          | ロケールをキーとした翻訳オブジェクト。 |
| `detectLocale`   | `boolean`           | `false`    | ブラウザからロケールを自動検出。       |
| `persistLocale`  | `boolean`           | `false`    | localStorage にロケールを保持。        |

### `useTranslation()`

コンポーネントで使用する翻訳ユーティリティを返します。

| プロパティ  | 型                                  | 説明                                   |
| :---------- | :---------------------------------- | :------------------------------------- |
| `t`         | `(key: string, params?) => string`  | オプションのパラメータでキーを翻訳。   |
| `locale`    | `Signal<string>`                    | リアクティブな現在のロケールシグナル。 |
| `setLocale` | `(locale: string) => Promise<void>` | 現在のロケールを変更。                 |
| `hasKey`    | `(key: string) => boolean`          | 翻訳キーが存在するか確認。             |

### `getI18n()`

コンポーネント外で直接アクセスするためのグローバル i18n インスタンスを返します。

```typescript
import { getI18n } from '@effuse/i18n';

const i18n = getI18n();
i18n.setLocale('es');
```
